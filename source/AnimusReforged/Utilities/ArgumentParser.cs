using AnimusReforged.Logging;

namespace AnimusReforged.Utilities;

/// <summary>
/// Provides utility methods for parsing and working with command-line arguments.
/// </summary>
public class ArgumentParser
{
    /// <summary>
    /// Converts an array of string arguments to a case-insensitive hash set for efficient lookups.
    /// </summary>
    /// <param name="args">The array of string arguments to convert, or null to create an empty set.</param>
    /// <returns>A hash set containing the arguments with case-insensitive string comparison.</returns>
    public static HashSet<string> ToArgumentSet(string[]? args)
    {
        Logger.Debug<ArgumentParser>($"Converting {(args?.Length ?? 0)} arguments to a hash set");

        HashSet<string> result = args == null
            ? new HashSet<string>(StringComparer.OrdinalIgnoreCase)
            : new HashSet<string>(args, StringComparer.OrdinalIgnoreCase);

        Logger.Debug<ArgumentParser>($"Created hash set with {result.Count} unique arguments");
        return result;
    }

    /// <summary>
    /// Checks if a specific argument exists in the provided array of arguments.
    /// </summary>
    /// <param name="args">The array of string arguments to search in, or null to search in an empty set.</param>
    /// <param name="arg">The argument to search for (case-insensitive).</param>
    /// <returns>True if the argument exists in the array, false otherwise.</returns>
    public static bool Contains(string[]? args, string arg)
    {
        Logger.Debug<ArgumentParser>($"Checking if argument '{arg}' exists in {(args?.Length ?? 0)} provided arguments");

        bool result = ToArgumentSet(args).Contains(arg);

        Logger.Debug<ArgumentParser>($"Argument '{arg}' {(result ? "found" : "not found")} in provided arguments");
        return result;
    }
}